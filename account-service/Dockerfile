FROM eclipse-temurin:21.0.2_13-jre
EXPOSE 8080

ENV SERVICE_NAME=account-service
ENV JAVA_OPTS -Xmx64m -Xms64m

ENV OTEL_SERVICE_NAME=account-service
ENV OTEL_EXPORTER_OTLP_PROTOCOL=grpc
ENV OTEL_INSTRUMENTATION_LOGBACK_APPENDER_EXPERIMENTAL_CAPTURE_MDC_ATTRIBUTES=*

ENTRYPOINT /opt/service/$SERVICE_NAME/bin/$SERVICE_NAME
HEALTHCHECK --interval=5s CMD curl -s -f http://localhost:8080/ping || exit 1

ADD $SERVICE_NAME.tar /opt/service/
